# AVDownloader Android APK æ‰“åŒ…è¯´æ˜

## ğŸ“± é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ AVDownloader çš„ Android ç§»åŠ¨ç«¯ç‰ˆæœ¬ï¼Œä½¿ç”¨ Kivy æ¡†æ¶å¼€å‘ï¼Œæ”¯æŒï¼š
- M3U8 è§†é¢‘æµä¸‹è½½
- TS åˆ†ç‰‡è‡ªåŠ¨åˆå¹¶
- åŠ å¯†è§†é¢‘è§£å¯†
- å¤šä»»åŠ¡æ‰¹é‡ä¸‹è½½
- æ–­ç‚¹ç»­ä¼ 

## ğŸ“ æ–‡ä»¶ç»“æ„

```
mobile/
â”œâ”€â”€ main.py                     # ä¸»ç¨‹åºå…¥å£ï¼ˆKivy UIï¼‰
â”œâ”€â”€ video_downloader_mobile.py  # è§†é¢‘ä¸‹è½½æ¨¡å—ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰
â”œâ”€â”€ ts_merger_mobile.py         # TSåˆå¹¶æ¨¡å—ï¼ˆçº¯Pythonå®ç°ï¼‰
â”œâ”€â”€ buildozer.spec              # Buildozeræ‰“åŒ…é…ç½®
â”œâ”€â”€ requirements.txt            # Pythonä¾èµ–
â”œâ”€â”€ build_apk.py                # æ‰“åŒ…è¾…åŠ©è„šæœ¬
â””â”€â”€ æ‰“åŒ…è¯´æ˜.md                  # æœ¬è¯´æ˜æ–‡æ¡£
```

## ğŸ”§ ç¯å¢ƒå‡†å¤‡

### 1. å®‰è£… Python ä¾èµ–

```bash
cd mobile
pip install -r requirements.txt
pip install buildozer
```

### 2. å®‰è£… Android SDK

#### æ–¹å¼ä¸€ï¼šé€šè¿‡ Android Studio å®‰è£…ï¼ˆæ¨èï¼‰

1. ä¸‹è½½å¹¶å®‰è£… [Android Studio](https://developer.android.com/studio)
2. æ‰“å¼€ Android Studioï¼Œè¿›å…¥ SDK Manager
3. å®‰è£…ä»¥ä¸‹ç»„ä»¶ï¼š
   - Android SDK Platform 31
   - Android SDK Build-Tools 31
   - Android NDK (Side by side) 25.2.9519653
   - Android SDK Command-line Tools

#### æ–¹å¼äºŒï¼šæ‰‹åŠ¨å®‰è£… SDK

1. ä¸‹è½½ [Android SDK Command Line Tools](https://developer.android.com/studio#command-tools)
2. è§£å‹åˆ°æŒ‡å®šç›®å½•ï¼Œä¾‹å¦‚ `C:\Android\Sdk`
3. è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```powershell
# PowerShell
[Environment]::SetEnvironmentVariable("ANDROID_HOME", "C:\Android\Sdk", "User")
[Environment]::SetEnvironmentVariable("Path", $env:Path + ";%ANDROID_HOME%\cmdline-tools\latest\bin;%ANDROID_HOME%\platform-tools", "User")
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

ç¡®ä¿ä»¥ä¸‹ç¯å¢ƒå˜é‡å·²è®¾ç½®ï¼š

```powershell
# æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $env:ANDROID_HOME

# å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œæ‰‹åŠ¨è®¾ç½®
$env:ANDROID_HOME = "C:\Users\<ä½ çš„ç”¨æˆ·å>\AppData\Local\Android\Sdk"
$env:Path += ";$env:ANDROID_HOME\platform-tools"
```

## ğŸ“¦ æ‰“åŒ…æ­¥éª¤

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ‰“åŒ…è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd mobile
python build_apk.py
```

æŒ‰æç¤ºé€‰æ‹©ï¼š
- é€‰é¡¹ 1ï¼šæ„å»º Debug ç‰ˆ APKï¼ˆç”¨äºæµ‹è¯•ï¼‰
- é€‰é¡¹ 2ï¼šæ„å»º Release ç‰ˆ APKï¼ˆéœ€è¦ç­¾åï¼‰
- é€‰é¡¹ 3ï¼šæ¸…ç†æ„å»ºæ–‡ä»¶

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ‰“åŒ…

```bash
cd mobile

# æ„å»º Debug ç‰ˆæœ¬
buildozer -v android debug

# æ„å»º Release ç‰ˆæœ¬ï¼ˆéœ€è¦ç­¾åï¼‰
buildozer -v android release
```

## â±ï¸ æ„å»ºæ—¶é—´

- é¦–æ¬¡æ„å»ºï¼š30-60 åˆ†é’Ÿï¼ˆéœ€è¦ä¸‹è½½å¤§é‡ä¾èµ–ï¼‰
- åç»­æ„å»ºï¼š5-15 åˆ†é’Ÿ

## ğŸ“¤ è·å– APK æ–‡ä»¶

æ„å»ºæˆåŠŸåï¼ŒAPK æ–‡ä»¶ä½äºï¼š

```
mobile/bin/
â”œâ”€â”€ avdownloader-1.0.0-arm64-v8a_armeabi-v7a-debug.apk  # Debugç‰ˆæœ¬
â””â”€â”€ avdownloader-1.0.0-arm64-v8a_armeabi-v7a-release.apk # Releaseç‰ˆæœ¬
```

## ğŸ” å‘å¸ƒç‰ˆç­¾åï¼ˆå¯é€‰ï¼‰

å¦‚éœ€å‘å¸ƒåˆ°åº”ç”¨å•†åº—ï¼Œéœ€è¦å¯¹ APK è¿›è¡Œç­¾åï¼š

```bash
# ç”Ÿæˆå¯†é’¥åº“
keytool -genkey -v -keystore avdownloader.keystore -alias avdownloader -keyalg RSA -keysize 2048 -validity 10000

# ç­¾åAPK
jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore avdownloader.keystore avdownloader-release-unsigned.apk avdownloader

# ä¼˜åŒ–APK
zipalign -v 4 avdownloader-release-unsigned.apk avdownloader-release.apk
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. æ„å»ºå¤±è´¥ï¼šæ‰¾ä¸åˆ° Android SDK

**è§£å†³æ–¹æ¡ˆï¼š**
```powershell
# è®¾ç½®ç¯å¢ƒå˜é‡
$env:ANDROID_HOME = "C:\Users\<ç”¨æˆ·å>\AppData\Local\Android\Sdk"
$env:ANDROID_SDK = $env:ANDROID_HOME

# éªŒè¯
ls $env:ANDROID_HOME\platforms
```

### 2. æ„å»ºå¤±è´¥ï¼šNDK ç‰ˆæœ¬ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆï¼š**
ç¼–è¾‘ `buildozer.spec`ï¼š
```ini
android.ndk = 25b  # ä¿®æ”¹ä¸ºä½ å®‰è£…çš„NDKç‰ˆæœ¬
```

### 3. åº”ç”¨é—ªé€€

**å¯èƒ½åŸå› ï¼š**
- ç¼ºå°‘å¿…è¦æƒé™
- å­˜å‚¨è·¯å¾„é—®é¢˜
- ä¾èµ–åº“ä¸å…¼å®¹

**è§£å†³æ–¹æ¡ˆï¼š**
æ£€æŸ¥ `buildozer.spec` ä¸­çš„æƒé™é…ç½®ï¼š
```ini
android.permissions = INTERNET,ACCESS_NETWORK_STATE,ACCESS_WIFI_STATE,WRITE_EXTERNAL_STORAGE,READ_EXTERNAL_STORAGE
```

### 4. ä¸‹è½½åŠŸèƒ½æ— æ³•ä½¿ç”¨

**æ£€æŸ¥äº‹é¡¹ï¼š**
1. ç¡®ä¿åº”ç”¨å·²è·å¾—å­˜å‚¨æƒé™
2. æ£€æŸ¥ç½‘ç»œè¿æ¥
3. æŸ¥çœ‹æ—¥å¿—è¾“å‡º

## ğŸ“± å®‰è£…åˆ°è®¾å¤‡

### æ–¹æ³•ä¸€ï¼šé€šè¿‡ ADB å®‰è£…

```bash
# è¿æ¥è®¾å¤‡å
adb install -r bin/avdownloader-1.0.0-arm64-v8a_armeabi-v7a-debug.apk
```

### æ–¹æ³•äºŒï¼šç›´æ¥ä¼ è¾“å®‰è£…

1. å°† APK æ–‡ä»¶ä¼ è¾“åˆ°æ‰‹æœº
2. åœ¨æ‰‹æœºä¸Šæ‰“å¼€ APK æ–‡ä»¶
3. å…è®¸å®‰è£…æœªçŸ¥æ¥æºåº”ç”¨
4. å®Œæˆå®‰è£…

## ğŸ”„ æ›´æ–°åº”ç”¨

ä¿®æ”¹ä»£ç åé‡æ–°æ‰“åŒ…ï¼š

```bash
# æ¸…ç†æ—§æ„å»ºï¼ˆå¯é€‰ï¼‰
buildozer android clean

# é‡æ–°æ„å»º
buildozer -v android debug
```

## ğŸ“‹ åŠŸèƒ½é™åˆ¶

ç§»åŠ¨ç«¯ç‰ˆæœ¬ç›¸æ¯”æ¡Œé¢ç‰ˆæœ‰ä»¥ä¸‹é™åˆ¶ï¼š

1. **ä¸æ”¯æŒæµè§ˆå™¨è‡ªåŠ¨åŒ–**ï¼šç§»åŠ¨ç«¯æ— æ³•ä½¿ç”¨ Selenium
2. **çº¯ TS åˆå¹¶**ï¼šä¸ä½¿ç”¨ ffmpegï¼Œç›´æ¥åˆå¹¶ TS æ–‡ä»¶
3. **å¹¶å‘æ•°é™åˆ¶**ï¼šå‡å°‘å¹¶å‘æ•°ä»¥é€‚åº”ç§»åŠ¨è®¾å¤‡æ€§èƒ½
4. **å­˜å‚¨ä½ç½®**ï¼šå›ºå®šä½¿ç”¨ `/sdcard/Download/AVDownloader`

## ğŸ“ ç‰ˆæœ¬å†å²

- **v1.0.0** (2026-02-09)
  - åˆå§‹ç‰ˆæœ¬
  - æ”¯æŒ M3U8 ä¸‹è½½
  - æ”¯æŒ TS åˆå¹¶
  - æ”¯æŒåŠ å¯†è§†é¢‘è§£å¯†

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Buildozer å®˜æ–¹æ–‡æ¡£ï¼šhttps://buildozer.readthedocs.io/
2. Kivy å®˜æ–¹æ–‡æ¡£ï¼šhttps://kivy.org/doc/stable/
3. æŸ¥çœ‹æ„å»ºæ—¥å¿—ï¼š`buildozer android debug 2>&1 | tee build.log`
